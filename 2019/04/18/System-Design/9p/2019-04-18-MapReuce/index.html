<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="System-Design/9p/2019-04-18-MapReuce"><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>System-Design/9p/2019-04-18-MapReuce | Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.1.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#General"><span class="toc-number">1.</span> <span class="toc-text">General</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Map-Reduce"><span class="toc-number">2.</span> <span class="toc-text">Map Reduce</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#統計單詞詞頻"><span class="toc-number">2.1.</span> <span class="toc-text">統計單詞詞頻</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#多选题-使用-For-循环统计单词个数有什么问题？"><span class="toc-number">2.1.0.0.1.</span> <span class="toc-text">[多选题]使用 For 循环统计单词个数有什么问题？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#单选题-按照内容存储顺序拆分统计，然后合并在一起的算法问题在哪儿？"><span class="toc-number">2.1.0.0.2.</span> <span class="toc-text">[单选题]按照内容存储顺序拆分统计，然后合并在一起的算法问题在哪儿？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#合併的時候是Bottle-Neck"><span class="toc-number">2.1.1.</span> <span class="toc-text">合併的時候是Bottle Neck!</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单选题-合并的时候以什么作为划分依据？"><span class="toc-number">2.1.1.0.1.</span> <span class="toc-text">[单选题]合并的时候以什么作为划分依据？</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Map-Reduce-框架流程"><span class="toc-number">3.</span> <span class="toc-text">Map Reduce 框架流程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单选题-Word-Count-为什么没有在-Map-的时候做聚合（Aggregation）？"><span class="toc-number">3.0.0.0.1.</span> <span class="toc-text">[单选题]Word Count 为什么没有在 Map 的时候做聚合（Aggregation）？</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MR-的使用"><span class="toc-number">4.</span> <span class="toc-text">MR 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单选题-在-Reduce-函数中，为什么-values-要用-Iterator-而不是简单的用一个数组？"><span class="toc-number">4.0.0.0.1.</span> <span class="toc-text">[单选题]在 Reduce 函数中，为什么 values 要用 Iterator 而不是简单的用一个数组？</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Word-Count"><span class="toc-number">4.1.</span> <span class="toc-text">Word Count</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#傳輸整理-shuffle"><span class="toc-number">5.</span> <span class="toc-text">傳輸整理 -  shuffle</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Practice-1"><span class="toc-number">6.</span> <span class="toc-text">Practice 1.</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Practice-2"><span class="toc-number">7.</span> <span class="toc-text">Practice 2.</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Map’s"><span class="toc-number">7.0.1.</span> <span class="toc-text">Map’s</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Practice-3-K-frequent-words"><span class="toc-number">8.</span> <span class="toc-text">Practice 3 K-frequent words</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#N-gram"><span class="toc-number">9.</span> <span class="toc-text">N-gram</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QA"><span class="toc-number">10.</span> <span class="toc-text">QA</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">286</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">25</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">41</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">System-Design/9p/2019-04-18-MapReuce</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-18</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/SystemDesign/">SystemDesign</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="General"><a href="#General" class="headerlink" title="General"></a>General</h1><h1 id="Map-Reduce"><a href="#Map-Reduce" class="headerlink" title="Map Reduce"></a>Map Reduce</h1><blockquote>
<p>Map<br> • 机器1，2 只负责把文章拆分为一个一个的单词</p>
<p>Reduce<br> • 机器3，4各负责一部分word的合并</p>
</blockquote>
<p>95%是在使用；　5%是在設計Map Reduce</p>
<p>只要大數據就該還是來了解</p>
<h2 id="統計單詞詞頻"><a href="#統計單詞詞頻" class="headerlink" title="統計單詞詞頻"></a>統計單詞詞頻</h2><ol>
<li>for + hash</li>
</ol>
<blockquote>
<h5 id="多选题-使用-For-循环统计单词个数有什么问题？"><a href="#多选题-使用-For-循环统计单词个数有什么问题？" class="headerlink" title="[多选题]使用 For 循环统计单词个数有什么问题？"></a>[多选题]使用 For 循环统计单词个数有什么问题？</h5><p>A.执行速度慢，单台机器要遍历所有单词50.47% 选择</p>
<p>B.耗费空间大，所有单词都要存储在 Hash 里进行计数统计47.48% 选择</p>
<p>C.编程复杂，代码实现难度高2.05% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是AB</p>
<p><strong>正确答案:</strong> AB</p>
</blockquote>
<ol start="2">
<li>多台機器平行統計，該怎麼切？</li>
</ol>
<blockquote>
<h5 id="单选题-按照内容存储顺序拆分统计，然后合并在一起的算法问题在哪儿？"><a href="#单选题-按照内容存储顺序拆分统计，然后合并在一起的算法问题在哪儿？" class="headerlink" title="[单选题]按照内容存储顺序拆分统计，然后合并在一起的算法问题在哪儿？"></a>[单选题]按照内容存储顺序拆分统计，然后合并在一起的算法问题在哪儿？</h5><p>A.无法做到均匀拆分26.18% 选择</p>
<p>B.机器的并行效率不高4.71% 选择</p>
<p>C.合并的时候太慢，会成为瓶颈69.11% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是C</p>
<p><strong>正确答案:</strong> C</p>
</blockquote>
<h3 id="合併的時候是Bottle-Neck"><a href="#合併的時候是Bottle-Neck" class="headerlink" title="合併的時候是Bottle Neck!"></a>合併的時候是Bottle Neck!</h3><p>是不是也可以平行？以什麼為標準來劃分？機器or Key?</p>
<blockquote>
<h5 id="单选题-合并的时候以什么作为划分依据？"><a href="#单选题-合并的时候以什么作为划分依据？" class="headerlink" title="[单选题]合并的时候以什么作为划分依据？"></a>[单选题]合并的时候以什么作为划分依据？</h5><p>A.机器25.45% 选择</p>
<p>B.Key74.55% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong> B</p>
<p><strong>解析:</strong> </p>
<p>以Key作为划分，设计简单，没有层次依赖性</p>
</blockquote>
<p>用機器的話會有層次、依賴性問題而拖慢整體速度。</p>
<h1 id="Map-Reduce-框架流程"><a href="#Map-Reduce-框架流程" class="headerlink" title="Map Reduce 框架流程"></a>Map Reduce 框架流程</h1><p>Map Reduce是一個分布式系統，整個都是由Master來控制的。</p>
<p>map的時候並沒有做合併aggregation的操作。</p>
<blockquote>
<h5 id="单选题-Word-Count-为什么没有在-Map-的时候做聚合（Aggregation）？"><a href="#单选题-Word-Count-为什么没有在-Map-的时候做聚合（Aggregation）？" class="headerlink" title="[单选题]Word Count 为什么没有在 Map 的时候做聚合（Aggregation）？"></a>[单选题]Word Count 为什么没有在 Map 的时候做聚合（Aggregation）？</h5><p>A.因为会使得编程复杂度提高15.39% 选择</p>
<p>B.因为聚合所需时间复杂度较高31.53% 选择</p>
<p>C.因为 Map Reduce 的框架会帮你实现41.83% 选择</p>
<p>D.因为 Map 的机器内存可能不够11.25% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是D</p>
<p><strong>正确答案:</strong> D</p>
</blockquote>
<p>不能在任何一個機器中開這個一樣哈希map。這裡不開的話，那麼整個系統都可以不開的。</p>
<h1 id="MR-的使用"><a href="#MR-的使用" class="headerlink" title="MR 的使用"></a>MR 的使用</h1><blockquote>
<p><strong>[LintCode 编程题]**</strong>[LintCode] Word Count (Map Reduce)**</p>
</blockquote>
<blockquote>
<h5 id="单选题-在-Reduce-函数中，为什么-values-要用-Iterator-而不是简单的用一个数组？"><a href="#单选题-在-Reduce-函数中，为什么-values-要用-Iterator-而不是简单的用一个数组？" class="headerlink" title="[单选题]在 Reduce 函数中，为什么 values 要用 Iterator 而不是简单的用一个数组？"></a>[单选题]在 Reduce 函数中，为什么 values 要用 Iterator 而不是简单的用一个数组？</h5><p>A.因为作者偏好使用 Iterator0.87% 选择</p>
<p>B.因为数组有可能在内存中会放不下，而 Iterator 具体实现的时候可能是从文件里分批次读取84.87% 选择</p>
<p>C.因为 Iterator 的读取效率比较快4.24% 选择</p>
<p>D.因为 Iterator 是一个接口，可以用数组来实现10.01% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong> B</p>
</blockquote>
<h2 id="Word-Count"><a href="#Word-Count" class="headerlink" title="Word Count"></a>Word Count</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordCount</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param &#123;str&#125; line a text, for example "Bye Bye see you next"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mapper</span><span class="params">(self, _, line)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value'</span></span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> line.split():</span><br><span class="line">            <span class="keyword">yield</span> w, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param key is from mapper</span></span><br><span class="line">    <span class="comment"># @param values is a set of value with the same key</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reducer</span><span class="params">(self, key, values)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value'</span></span><br><span class="line">        <span class="keyword">yield</span> key, sum(values)</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(String key, String value, OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, int value);</span></span><br><span class="line">            StringTokenizer tokenizer = <span class="keyword">new</span> StringTokenizer(value);</span><br><span class="line">            <span class="keyword">while</span> (tokenizer.hasMoreTokens()) &#123;</span><br><span class="line">                String outputKey = tokenizer.nextToken();</span><br><span class="line">                output.collect(outputKey, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Reduce</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(String key, Iterator&lt;Integer&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                           OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, int value);</span></span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (values.hasNext()) &#123;</span><br><span class="line">                sum += values.next();</span><br><span class="line">            &#125;</span><br><span class="line">            output.collect(key, sum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="傳輸整理-shuffle"><a href="#傳輸整理-shuffle" class="headerlink" title="傳輸整理 -  shuffle"></a>傳輸整理 -  shuffle</h1><ul>
<li>Partition sort  +  Fetch&amp;Merge</li>
</ul>
<p>當map完怎麼傳給其他機器做reduce?</p>
<ol>
<li>把結果以為key作分組，master有個一致性哈希去作分組。</li>
<li>對組內部作硬盤上的外排序。以key為第一關鍵字，value為第二關鍵字。</li>
<li>３號會再作k路merge，把這些文件合成一個reduce的輸入</li>
</ol>
<blockquote>
<ul>
<li>请问，这里的K路归并需要使用hashmap吗？如果不用的话是如何实现的？如果用的话不是说内存装不下吗？<ul>
<li>k路归并不需要使用hashmap，可以只用少量的内存完成。方法是：每次选取k路中最小的元素，将其放入存放结果的队列，然后重复执行以上两步。存放结果的队列可以直接在硬盘上</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="Practice-1"><a href="#Practice-1" class="headerlink" title="Practice 1."></a>Practice 1.</h1><p>Inverted Index as Search Engine</p>
<blockquote>
<ul>
<li>一个key占一个reducer吗？还是可以多个key放一个reducer？<ul>
<li>多个key放一个reducer。<br>假设有R个Reducer，map函数产生的key-value pair会被一个hash function(原paper里叫partition function)分成R份，哈希值相同的key会被归到同一个Reducer里，然后Reducer会把这些key-value pair分组，同一个key的value拼在一起之后传给用户编写的reduce函数。</li>
</ul>
</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Definition of Document</span></span><br><span class="line"><span class="string">class Document:</span></span><br><span class="line"><span class="string">    def __init__(self, id, cotent):</span></span><br><span class="line"><span class="string">        self.id = id</span></span><br><span class="line"><span class="string">        self.content = content</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InvertedIndex</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param &#123;Document&#125; value is a document</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mapper</span><span class="params">(self, _, value)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="comment"># for word in range(value.content.split()):</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> value.content.split(): </span><br><span class="line">            <span class="keyword">yield</span> word, value.id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param key is from mapper</span></span><br><span class="line">    <span class="comment"># @param values is a set of value with the same key</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reducer</span><span class="params">(self, key, values)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="comment"># res = []</span></span><br><span class="line">        <span class="comment"># # print(type(values))</span></span><br><span class="line">        <span class="comment"># for val in values:</span></span><br><span class="line">        <span class="comment">#     res.append(val)  </span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">yield</span> key, sorted(list(set(values)))</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition of OutputCollector:</span></span><br><span class="line"><span class="comment"> * class OutputCollector&lt;K, V&gt; &#123;</span></span><br><span class="line"><span class="comment"> *     public void collect(K key, V value);</span></span><br><span class="line"><span class="comment"> *         // Adds a key/value pair to the output buffer</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> * Definition of Document:</span></span><br><span class="line"><span class="comment"> * class Document &#123;</span></span><br><span class="line"><span class="comment"> *     public int id;</span></span><br><span class="line"><span class="comment"> *     public String content;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InvertedIndex</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(String _, Document value,</span></span></span><br><span class="line"><span class="function"><span class="params">                        OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, int value);</span></span><br><span class="line">            <span class="keyword">int</span> id = value.id;</span><br><span class="line">            StringTokenizer tokenizer = <span class="keyword">new</span> StringTokenizer(value.content);</span><br><span class="line">            <span class="keyword">while</span> (tokenizer.hasMoreTokens()) &#123;</span><br><span class="line">                String word = tokenizer.nextToken();</span><br><span class="line">                output.collect(word, id);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Reduce</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(String key, Iterator&lt;Integer&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                           OutputCollector&lt;String, List&lt;Integer&gt;&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, List&lt;Integer&gt; value);</span></span><br><span class="line">            List&lt;Integer&gt; results = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">            <span class="keyword">int</span> previous = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (values.hasNext()) &#123;</span><br><span class="line">                <span class="keyword">int</span> now = values.next();</span><br><span class="line">                <span class="keyword">if</span>(previous != now) &#123;</span><br><span class="line">                    results.add(now);</span><br><span class="line">                &#125;</span><br><span class="line">                previous = now;</span><br><span class="line">            &#125;</span><br><span class="line">            output.collect(key, results);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Practice-2"><a href="#Practice-2" class="headerlink" title="Practice 2."></a>Practice 2.</h1><p>Anagram grouping</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Anagram</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param &#123;str&#125; line a text, for example "Bye Bye see you next"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mapper</span><span class="params">(self, _, line)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> line.split():</span><br><span class="line">            <span class="comment"># print(word)</span></span><br><span class="line">            <span class="keyword">yield</span> <span class="string">''</span>.join(sorted(word)), word</span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param key is from mapper</span></span><br><span class="line">    <span class="comment"># @param values is a set of value with the same key</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reducer</span><span class="params">(self, key, values)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="comment"># res = []</span></span><br><span class="line">        <span class="keyword">yield</span> key, list(values)</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition of OutputCollector:</span></span><br><span class="line"><span class="comment"> * class OutputCollector&lt;K, V&gt; &#123;</span></span><br><span class="line"><span class="comment"> *     public void collect(K key, V value);</span></span><br><span class="line"><span class="comment"> *         // Adds a key/value pair to the output buffer</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Anagram</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(String key, String value, OutputCollector&lt;String, String&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, String value);</span></span><br><span class="line">            StringTokenizer tokenizer = <span class="keyword">new</span> StringTokenizer(value);</span><br><span class="line">            <span class="keyword">while</span> (tokenizer.hasMoreTokens()) &#123;</span><br><span class="line">                String word = tokenizer.nextToken();</span><br><span class="line">                String original = word;</span><br><span class="line">                <span class="keyword">char</span>[] chars = original.toCharArray();</span><br><span class="line">                Arrays.sort(chars);</span><br><span class="line">                String sorted = <span class="keyword">new</span> String(chars);</span><br><span class="line">                output.collect(sorted, word);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Reduce</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(String key, Iterator&lt;String&gt; values, OutputCollector&lt;String, List&lt;String&gt;&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, List&lt;String&gt; value);</span></span><br><span class="line">            List&lt;String&gt; results = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">while</span> (values.hasNext()) &#123;</span><br><span class="line">                results.add(values.next());</span><br><span class="line">            &#125;</span><br><span class="line">            output.collect(key, results);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Map’s"><a href="#Map’s" class="headerlink" title="Map’s"></a>Map’s</h3><ul>
<li><p>Key: 經內部字母排序後的單詞 (會一樣)</p>
</li>
<li><p>Value : 未經排序的</p>
</li>
</ul>
<blockquote>
<ul>
<li><p>map结果传输给reducer是不是要通过网络传输？这样的速度够用吗</p>
<ul>
<li>map结果是通过网络传给reducer，map和reducer一般同在一个内网，网速够用</li>
</ul>
</li>
<li><p>mapReduce中master机器不会用于管理所有数据的metadata吗？</p>
<ul>
<li><p>master不负责中间计算结果的相关数据。</p>
</li>
<li><p>再补充几个常见的 QA:</p>
<p>Q: Reduce 之后各个key还是可能会在不同地方，那么怎么再把这些 reducer 的结果 sort 并放在一起呢？<br>A: Reducer 的结果在全局是不 sort 的。因为很多计算场景下计算结果不需要 sort。如果有 sort 的需求，可以使用外排序算法（External Sorting）进行排序即可。</p>
</li>
<li><p>Q: 系统设计中 map reduce 的问题会以什么形式问？<br>A: 90% 的概率会问使用 map reduce 来解决比较重的计算问题。10% 的概率会问 map reduce 的原理是怎么样的。所以好好做今天的编程题作业非常重要！</p>
</li>
<li><p>Q: Reduce 的过程全部都在内存里么？是否会装不下？<br>A: 不是的。Reduce 的过程，key 是在内存里的，value list 通常在代码中是一个 iterator 的形式，也就意味着，有可能是从文件里读进来的。很显然全部放在内存肯定是放不下的，特别是对一些很 hot 的 key。</p>
</li>
<li></li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="Practice-3-K-frequent-words"><a href="#Practice-3-K-frequent-words" class="headerlink" title="Practice 3 K-frequent words"></a>Practice 3 K-frequent words</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Definition of Document</span></span><br><span class="line"><span class="string">class Document:</span></span><br><span class="line"><span class="string">    def __init__(self, id, content):</span></span><br><span class="line"><span class="string">        self.id = id</span></span><br><span class="line"><span class="string">        self.content = content</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> Mr_tools <span class="keyword">import</span> Document</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TopKFrequentWords</span>:</span></span><br><span class="line">    <span class="comment"># @param &#123;Document&#125; value is a document and value have two attributes(id and content)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mapper</span><span class="params">(self, _, value)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="comment"># key is word and value is 1</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> value.content.split():</span><br><span class="line">            <span class="keyword">yield</span> word, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param key is from mapper</span></span><br><span class="line">    <span class="comment"># @param values is a list of document</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reducer</span><span class="params">(self, key, values)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="comment"># key is word, value is count</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># yield key, reversed(sorted(values))</span></span><br><span class="line">        <span class="keyword">yield</span> key, values   <span class="comment"># 框架天生就已经照 DESC 排好了</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition of OutputCollector:</span></span><br><span class="line"><span class="comment"> * class OutputCollector&lt;K, V&gt; &#123;</span></span><br><span class="line"><span class="comment"> *     public void collect(K key, V value);</span></span><br><span class="line"><span class="comment"> *         // Adds a key/value pair to the output buffer</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> * Definition of Document:</span></span><br><span class="line"><span class="comment"> * class Document &#123;</span></span><br><span class="line"><span class="comment"> *     public int id;</span></span><br><span class="line"><span class="comment"> *     public String content;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pair</span> </span>&#123;</span><br><span class="line">    String key;</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    </span><br><span class="line">    Pair(String key, <span class="keyword">int</span> value) &#123;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TopKFrequentWords</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(String _, Document value,</span></span></span><br><span class="line"><span class="function"><span class="params">                        OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, int value);</span></span><br><span class="line">            <span class="keyword">int</span> id = value.id;</span><br><span class="line">            String content = value.content;</span><br><span class="line">            String[] words = content.split(<span class="string">" "</span>);</span><br><span class="line">            <span class="keyword">for</span> (String word : words)</span><br><span class="line">                <span class="keyword">if</span> (word.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    output.collect(word, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Reduce</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> PriorityQueue&lt;Pair&gt; Q = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> k;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Comparator&lt;Pair&gt; pairComparator = <span class="keyword">new</span> Comparator&lt;Pair&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Pair left, Pair right)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (left.value != right.value) &#123;</span><br><span class="line">                    <span class="keyword">return</span> left.value - right.value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> right.key.compareTo(left.key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// initialize your data structure here</span></span><br><span class="line">            <span class="keyword">this</span>.k = k;</span><br><span class="line">            Q = <span class="keyword">new</span> PriorityQueue&lt;Pair&gt;(k, pairComparator);</span><br><span class="line">        &#125;   </span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(String key, Iterator&lt;Integer&gt; values)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (values.hasNext()) &#123;</span><br><span class="line">                    sum += values.next();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Pair pair = <span class="keyword">new</span> Pair(key, sum);</span><br><span class="line">            <span class="keyword">if</span> (Q.size() &lt; k) &#123;</span><br><span class="line">                Q.add(pair);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Pair peak = Q.peek();</span><br><span class="line">                <span class="keyword">if</span> (pairComparator.compare(pair, peak) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    Q.poll();</span><br><span class="line">                    Q.add(pair);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cleanup</span><span class="params">(OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Output the top k pairs &lt;word, times&gt; into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, Integer value);</span></span><br><span class="line">            List&lt;Pair&gt; pairs = <span class="keyword">new</span> ArrayList&lt;Pair&gt;();</span><br><span class="line">            <span class="keyword">while</span> (!Q.isEmpty()) &#123;</span><br><span class="line">                pairs.add(Q.poll());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// reverse result</span></span><br><span class="line">            <span class="keyword">int</span> n = pairs.size();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">                Pair pair = pairs.get(i);</span><br><span class="line">                output.collect(pair.key, pair.value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="N-gram"><a href="#N-gram" class="headerlink" title="N-gram"></a>N-gram</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NGram</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param &#123;int&#125; n a integer</span></span><br><span class="line">    <span class="comment"># @param &#123;str&#125; string a string</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mapper</span><span class="params">(self, _, n, string)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="keyword">for</span> start <span class="keyword">in</span> range(len(string)-n+<span class="number">1</span>):</span><br><span class="line">            word = string[start:start+n]</span><br><span class="line">            <span class="keyword">yield</span> word, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># @param key is from mapper</span></span><br><span class="line">    <span class="comment"># @param values is a set of value with the same key</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reducer</span><span class="params">(self, key, values)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># Please use 'yield key, value' here</span></span><br><span class="line">        <span class="keyword">yield</span> key, sum(values)</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition of OutputCollector:</span></span><br><span class="line"><span class="comment"> * class OutputCollector&lt;K, V&gt; &#123;</span></span><br><span class="line"><span class="comment"> *     public void collect(K key, V value);</span></span><br><span class="line"><span class="comment"> *         // Adds a key/value pair to the output buffer</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NGram</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(String _, <span class="keyword">int</span> n, String str,</span></span></span><br><span class="line"><span class="function"><span class="params">                        OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, Integer value);</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; str.length() - n + <span class="number">1</span>; ++index) &#123;</span><br><span class="line">                output.collect(str.substring(index, index + n), <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Reduce</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(String key, Iterator&lt;Integer&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                           OutputCollector&lt;String, Integer&gt; output)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Write your code here</span></span><br><span class="line">            <span class="comment">// Output the results into output buffer.</span></span><br><span class="line">            <span class="comment">// Ps. output.collect(String key, int value);</span></span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (values.hasNext()) &#123;</span><br><span class="line">                    sum += values.next();</span><br><span class="line">            &#125;</span><br><span class="line">            output.collect(key, sum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h1><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200419212810217.png" alt="image-20200419212810217" style="zoom: 50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gdzedcrqyjj30k20tyn18.jpg" alt="image-20200419212855454" style="zoom:50%;" />

<blockquote>
<p>1T 的数据很大，通常很难找到内存超过 1T 的电脑。但是内存超过 1G 的还是很容易的。因此 A 肯定是不对的。如果我们能找到一个算法比较均匀的拆分 1T 的数据到 1024 个 1G 的文件的话，每个文件都可以导入内存中进行排序，最后我们再归并排序后的结果即可。这个拆分排序再归并的算法就是外排序算法。</p>
<ul>
<li>选项 B，按照数据的范围进行拆分，会导致分配不均匀，比如大部分的数据都在一个很小的范围内。而且不是所有的数据都有可数范围，如字符串是很难划定范围的。</li>
<li>选项 C，按照 hash 之后的结果进行拆分，也会导致数据拆分不均匀，因而使得某些部分可能依然无法导入内存。</li>
<li>选项 D，按照实际存储位置进行拆分，这样才能够确保每个部分可以导入内存。</li>
</ul>
</blockquote>
<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200420002016032.png" alt="image-20200420002016032" style="zoom:50%;" />

<blockquote>
<ul>
<li>Map 的机器如果没有全部执行完，任何一台 Reduce 的机器所负责的数据段都有可能还有更新。因此 Reduce 的部分是不可以开始的。但是机器可以先启动执行一些程序的初始化操作是可以的。</li>
</ul>
</blockquote>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gdzjbais4qj30ju0v0429.jpg" alt="image-20200420001955882" style="zoom:50%;" />

<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200420002035928.png" alt="image-20200420002035928" style="zoom:50%;" /></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joe Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/04/18/System-Design/9p/2019-04-18-MapReuce/">http://yoursite.com/2019/04/18/System-Design/9p/2019-04-18-MapReuce/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/04/22/Algo.%20Ult./note/"><i class="fa fa-chevron-left">  </i><span>Algo. Ult./note</span></a></div><div class="next-post pull-right"><a href="/2019/04/15/System-Design/201-08-08-BigTiger-Big%20Table/"><span>System-Design/201-08-08-BigTiger-Big Table</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>