<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.1.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">298</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">25</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">45</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2018/11/20/ML/2018-11-20-ML%20Review-1/">ML/2018-11-20-ML Review-1</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Machine-Learning/">Machine-Learning</a></span><div class="content"><h3 id="1-SVM"><a href="#1-SVM" class="headerlink" title="1. SVM"></a>1. SVM</h3><p>Ref: <a href="https://blog.csdn.net/sinat_35512245/article/details/54984251" target="_blank" rel="noopener">https://blog.csdn.net/sinat_35512245/article/details/54984251</a><br>$$<br>d=|w^Tx+b|||w||　　　　　　　　　　　（１）<br>$$<br>其中，||w||为w的范数。</p>
<p>当点A表示某一实例$x_i$，其类标记为yi=+1yi=+1。点A与超平面的距离记作didi，那么<br>$$<br>di=wTxi+b||w||　　　　　　　　　　（２）<br>$$<br>当点A表示某一实例xixi，其类标记为yi=−1yi=−1。点A与超平面的距离记作didi，那么<br>$$<br>di=−wTxi+b||w||　　　　　　　　　（３）<br>$$<br>一般地，点xixi与超平面的距离是<br>$$<br>di=yiwTxi+b||w||　　　　　　　　　（４）<br>$$<br>公式（４）也被称为超平面关于样本点xixi的几何间隔。</p>
<h4 id="最大间隔分离超平面"><a href="#最大间隔分离超平面" class="headerlink" title="最大间隔分离超平面"></a>最大间隔分离超平面</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g9cwe8dihaj30c007cdgl.jpg" alt="这里写图片描述"></p>
<p>如上图所示，距离超平面最近的这几个训练样本点被称为<strong>支持向量</strong>，两个异类支持向量（即分别位于超平面两侧的点）到超平面的距离之和为<br>$$<br>d=2/||w||　　　　　　　　　　　　　　　（５）<br>$$<br>上面（5）的d称为间隔（margin）。<br>要求得最大间隔（即最大化 $2/w$），就是要满足：</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g9cwamnyyij309h02sjrb.jpg" alt="这里写图片描述"></p>
<p>显然，为了最大化间隔，仅需最大化$||w||^{−1}$，这等价于最小化$||w||^2$，于是上式可以重写为：</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g9cwaz5iy0j309u02mdfs.jpg" alt="这里写图片描述"></p>
<p>这就是支持向量机的基本模型。</p>
<p><strong>到目前为止，我们的 SVM 还比较弱，只能处理线性的情况，下面我们将引入核函数，进而推广到非线性分类问题。</strong></p>
<p><strong>非线性支持向量机和核函数</strong></p>
<p>非线性分类问题是指通过利用非线性模型才能很好地进行分类的问题。先看一个例子：</p>
<hr>
<h3 id="2-DeepLearning-Frameworks-Dynamic-vs-Static-Graphs"><a href="#2-DeepLearning-Frameworks-Dynamic-vs-Static-Graphs" class="headerlink" title="2. DeepLearning Frameworks: Dynamic vs Static Graphs"></a>2. DeepLearning Frameworks: Dynamic vs Static Graphs</h3><h1 id="动态图-vs-静态图"><a href="#动态图-vs-静态图" class="headerlink" title="动态图 vs. 静态图"></a>动态图 vs. 静态图</h1><p>ref: <a href="https://www.cnblogs.com/yifdu25/p/8763717.html" target="_blank" rel="noopener">https://www.cnblogs.com/yifdu25/p/8763717.html</a></p>
<p>在 fast.ai，我们在选择框架时优先考虑程序员编程的便捷性（能更方便地进行调试和更直观地设计），而不是框架所能带来的模型加速能力。这也正是我们选择 PyTorch 的理由，因为它是一个<strong>具有动态图机制的灵活框架</strong>。</p>
<p>依据采用动态计算或是静态计算的不同，可以将这些众多的深度学习框架划分成两大阵营，当然也有些框架同时具有动态计算和静态计算两种机制（比如 MxNet 和最新的 TensorFlow）。动态计算意味着程序将按照我们编写命令的顺序进行执行。这种机制将使得调试更加容易，并且也使得我们将大脑中的想法转化为实际代码变得更加容易。而静态计算则意味着程序在编译执行时将先生成神经网络的结构，然后再执行相应操作。从理论上讲，静态计算这样的机制允许编译器进行更大程度的优化，但是这也意味着你所期望的程序与编译器实际执行之间存在着更多的代沟。这也意味着，代码中的错误将更加难以发现（比如，如果计算图的结构出现问题，你可能只有在代码执行到相应操作的时候才能发现它）。<strong>尽管理论上而言，静态计算图比动态计算图具有更好的性能，但是在实践中我们经常发现并不是这样的。</strong></p>
<p>谷歌的 TensorFlow 主要使用了静态计算图，而 Facebook 的 PyTorch 则使用了动态计算图机制。（注：TensorFlow 在两周前宣布了一个动态计算选项 Eager Execution（<a href="http://t.cn/RlZizQ2），不过该特性还比较新颖并且" target="_blank" rel="noopener">http://t.cn/RlZizQ2），不过该特性还比较新颖并且</a> TensorFlow 的文档和项目依然以静态计算为主）。在九月份，fast.ai 宣布将在今年的课程中采用 PyTorch 框架进行教学以及开发 fast.ai 自己的框架（实际上就是采用了更好的编码方式对 PyTorch 进行高级封装）。简而言之，以下是我们选择 PyTorch 的几个原因（更详细的原因请参见这里<a href="http://t.cn/Rpqj6pu）：" target="_blank" rel="noopener">http://t.cn/Rpqj6pu）：</a></p>
<ul>
<li>更加容易调试</li>
<li>动态计算更适用于自然语言处理</li>
<li>传统的面向对象编程风格（这对我们来说更加自然）</li>
<li>TensorFlow 中采用的诸如 scope 和 sessions 等不寻常的机制容易使人感到疑惑不解，而且需要花费更多时间学习</li>
</ul>
<p>谷歌在推广 TensorFlow 上已经花费了大量的资源，其投入要远远大于任何其它公司或者团队，并且我想这也是为什么 TensorFlow 会如此出名的原因之一（对于很多深度学习的门外汉，TensorFlow 是他们唯一听说过的框架）。正如之前所述，TensorFlow 在几周前发布了动态计算选项，这将解决了一些上述提到的问题。然后许多人就向 fast.ai 提问说我们是否考虑迁移回 TensorFlow 框架。<strong>但是目前 TensorFlow 提供的动态选项还比较新颖而且开发也不够完善，所以我们依然选择继续愉快地使用 PyTorch</strong>。但是 TensorFlow 团队非常乐意于接受我们的想法，我们也很高兴看到我们的 fastai 库（<a href="http://t.cn/RYyK6jC）被移植到" target="_blank" rel="noopener">http://t.cn/RYyK6jC）被移植到</a> TensorFlow 中。</p>
<hr>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/11/06/DevOps/2018-11-06-Jupyter%20Ipykernel/">DevOps/2018-11-06-Jupyter Ipykernel</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/DevOps/">DevOps</a></span><div class="content"><h2 id="Conda"><a href="#Conda" class="headerlink" title="Conda"></a>Conda</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">list all env:</span><br><span class="line"></span><br><span class="line">conda info --env</span><br><span class="line"></span><br><span class="line">create a simple virtual env:</span><br><span class="line"></span><br><span class="line">conda create -n YourEnvName python=3*</span><br><span class="line"></span><br><span class="line">delete virtual env</span><br><span class="line"></span><br><span class="line">conda env remove -n NAME</span><br></pre></td></tr></table></figure>



<h2 id="Jupyter"><a href="#Jupyter" class="headerlink" title="Jupyter"></a>Jupyter</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> activate myenv</span><br><span class="line">pip install ipykernel</span><br><span class="line">python -m ipykernel install --user --name myenv --display-name <span class="string">"Python (myenv)"</span></span><br></pre></td></tr></table></figure>

<p><em>Installed kernelspec joe_segmentation_36 in /mnt/raid1/home/huangjiancong/.local/share/jupyter/kernels/joe_segmentation_36</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(joe4_py36) xxx@hpc4:~$ python -m ipykernel install --user --name joe4_py36_kernel --display-name <span class="string">"Joe4_Py36_Kernel"</span></span><br></pre></td></tr></table></figure>

<p><em>Installed kernelspec joe4_py36_kernel in /mnt/raid4/home/huangjiancong/.local/share/jupyter/kernels/joe4_py36_kernel</em></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/11/05/DevOps/2018-11-05-Docker%20Note/">DevOps/2018-11-05-Docker Note</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-05</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/DevOps/">DevOps</a></span><div class="content"><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">Docker:</span><br><span class="line">$ docker pull ubuntu:<span class="number">18.04</span></span><br><span class="line">因此将会获取官方镜像 library/ubuntu 仓库</span><br><span class="line"></span><br><span class="line">$ docker <span class="keyword">run</span><span class="bash"> -it (—rm 表示<span class="built_in">exit</span>后自动删除掉) ubuntu:18.04 bash  或 把it 改成dt</span></span><br><span class="line">root@<span class="number">569</span>c032785f2:/<span class="comment"># pwd</span></span><br><span class="line">/</span><br><span class="line">root@aaa:<span class="comment"># exit</span></span><br><span class="line">$ docker exec -it $CON_ID bash</span><br><span class="line"></span><br><span class="line">$ docker ps -a  &lt;==例出所有containers ;  docker rm $CON_ID</span><br><span class="line">$ docker ps -n5</span><br><span class="line">$ docker stop $CON_ID</span><br><span class="line">$ docker start $CON_ID</span><br><span class="line"></span><br><span class="line">╰$ cat Dockerfile</span><br><span class="line"><span class="keyword">FROM</span> registry.cn-hangzhou.aliyuncs.com/eigenlab/ideal-video:latest</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="string">'aaaaaaaaaaaaaaaaa'</span> &gt; ./test_aaa.log</span></span><br><span class="line">╰$ docker build -t aaa:v1</span><br><span class="line">╰$ docker image prune</span><br><span class="line">WARNING! This will remove all dangling images.</span><br><span class="line">Are you sure you want to continue? [y/N] y</span><br><span class="line">Deleted Images:</span><br><span class="line">deleted: sha256:<span class="number">0015</span>c03359ec60e4f133bb382dc0662f976dbebed7cdf70bf50bd9efca82052e</span><br><span class="line"></span><br><span class="line">Total reclaimed space: <span class="number">0</span>B</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Docker:</span><br><span class="line">$ docker pull ubuntu:<span class="number">18.04</span></span><br><span class="line">因此将会获取官方镜像 library/ubuntu 仓库</span><br><span class="line"></span><br><span class="line">$ docker <span class="keyword">run</span><span class="bash"> -it (—rm 表示<span class="built_in">exit</span>后自动删除掉) ubuntu:18.04 bash  或 把it 改成dt</span></span><br><span class="line">root@<span class="number">569</span>c032785f2:/<span class="comment"># pwd</span></span><br><span class="line">/</span><br><span class="line">root@aaa:<span class="comment"># exit</span></span><br><span class="line">$ docker exec -it $CON_ID bash</span><br><span class="line"></span><br><span class="line">$ docker ps -a  &lt;==例出所有containers ;  docker rm $CON_ID</span><br><span class="line">$ docker ps -n5</span><br><span class="line">$ docker stop $CON_ID</span><br><span class="line">$ docker start $CON_ID</span><br><span class="line"></span><br><span class="line">╰$ cat Dockerfile</span><br><span class="line"><span class="keyword">FROM</span> registry.cn-hangzhou.aliyuncs.com/eigenlab/ideal-video:latest</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="string">'aaaaaaaaaaaaaaaaa'</span> &gt; ./test_aaa.log</span></span><br><span class="line">╰$ docker build -t aaa:v1</span><br><span class="line">╰$ docker image prune</span><br><span class="line">WARNING! This will remove all dangling images.</span><br><span class="line">Are you sure you want to continue? [y/N] y</span><br><span class="line">Deleted Images:</span><br><span class="line">deleted: sha256:<span class="number">0015</span>c03359ec60e4f133bb382dc0662f976dbebed7cdf70bf50bd9efca82052e</span><br><span class="line"></span><br><span class="line">Total reclaimed space: <span class="number">0</span>B</span><br></pre></td></tr></table></figure>





<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run  -p 5599:5599 -p 8023:22 --name=<span class="string">"wazowski_joe_1106"</span> -v ~/workspace:/remote_workspace -it registry.cn-hangzhou.aliyuncs.com/eigenlab/wazowski_1688_leo:44 bash</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">huangjiancong@hpc3:~$ sudo docker port wazowski_joe_1106  22</span><br><span class="line">[sudo] password <span class="keyword">for</span> huangjiancong:</span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password <span class="keyword">for</span> huangjiancong:</span><br><span class="line">0.0.0.0:8023</span><br><span class="line">huangjiancong@hpc3:~$ ss -tulwn | grep 8023</span><br><span class="line">tcp    LISTEN     0      128      :::8023                 :::*</span><br></pre></td></tr></table></figure>



<p>不过没有关系，知道原理就行，根据提示 <strong>Offending ECDSA key in /root/.ssh/known_hosts:9</strong> ，删除路径中的第九行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sed -i <span class="string">'9d'</span> /root/.ssh/known_hosts</span><br></pre></td></tr></table></figure>



<p>Docker check mounted path </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect -f <span class="string">"&#123;&#123; .Mounts &#125;&#125;"</span>  7a96</span><br></pre></td></tr></table></figure>

<p>[{bind  /home/$USER/workspace/exp/docker_/opencv347 /workspace/remote_opencv347   true rprivate}]</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/10/21/LC/2018-10-21-python-Closure%20&amp;%20Non-local%20vs%20Global/">LC/2018-10-21-python-Closure &amp; Non-local vs Global</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-10-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/python/">python</a></span><div class="content"><h3 id="Closure-amp-Non-local-vs-Global"><a href="#Closure-amp-Non-local-vs-Global" class="headerlink" title="Closure &amp; Non-local vs Global"></a>Closure &amp; Non-local vs Global</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">方法一：创建生成器            </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatCounter</span><span class="params">( )</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">( )</span>:</span></span><br><span class="line">        x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">              x = x +<span class="number">1</span></span><br><span class="line">              <span class="keyword">yield</span> x</span><br><span class="line">    </span><br><span class="line">    sum = f( ) </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">def</span>  <span class="title">counter</span><span class="params">( )</span>:</span></span><br><span class="line">         <span class="keyword">return</span> next( sum )</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> counter</span><br></pre></td></tr></table></figure>



<p>这里没有直接调用f( )，即next( f( ) )，而是用定义sum = f( )，即next( sum )，</p>
<p>因为creatCounter( )返回的是counter这个函数，而此时f( )并没有执行并返回一个生成器对象，而执行next（sum）则会执行f( )生成一个新的生成器对象，变向的理解，s1 = f( )，s2 = f( )，但s1 == s2是false（这个变向理解感觉有点牵强）</p>
<p>方法二：创建列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatCounter</span><span class="params">()</span>:</span></span><br><span class="line">    s = [<span class="number">0</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">        s[<span class="number">0</span>] = s[<span class="number">0</span>] + <span class="number">1</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creat_counter</span><span class="params">()</span>:</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line">    <span class="keyword">return</span> counter</span><br></pre></td></tr></table></figure>



<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g8885skue5j30v30u042e.jpg" alt="image-20191023164204053"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g888hveiitj30dd0v4420.jpg" alt="image-20191023165343479"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g888i4jauxj30db0saq6i.jpg" alt="image-20191023165358740"></p>
<p>Ref:</p>
<p><a href="https://www.jianshu.com/p/703ad1289a00" target="_blank" rel="noopener">https://www.jianshu.com/p/703ad1289a00</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/10/21/Python/2018-10-21-python-Closure%20&amp;%20Non-local%20vs%20Global/">Python/2018-10-21-python-Closure &amp; Non-local vs Global</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-10-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Python/">Python</a></span><div class="content"><h3 id="Closure-amp-Non-local-vs-Global"><a href="#Closure-amp-Non-local-vs-Global" class="headerlink" title="Closure &amp; Non-local vs Global"></a>Closure &amp; Non-local vs Global</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">方法一：创建生成器            </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatCounter</span><span class="params">( )</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">( )</span>:</span></span><br><span class="line">        x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">              x = x +<span class="number">1</span></span><br><span class="line">              <span class="keyword">yield</span> x</span><br><span class="line">    </span><br><span class="line">    sum = f( ) </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">def</span>  <span class="title">counter</span><span class="params">( )</span>:</span></span><br><span class="line">         <span class="keyword">return</span> next( sum )</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> counter</span><br></pre></td></tr></table></figure>



<p>这里没有直接调用f( )，即next( f( ) )，而是用定义sum = f( )，即next( sum )，</p>
<p>因为creatCounter( )返回的是counter这个函数，而此时f( )并没有执行并返回一个生成器对象，而执行next（sum）则会执行f( )生成一个新的生成器对象，变向的理解，s1 = f( )，s2 = f( )，但s1 == s2是false（这个变向理解感觉有点牵强）</p>
<p>方法二：创建列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatCounter</span><span class="params">()</span>:</span></span><br><span class="line">    s = [<span class="number">0</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">        s[<span class="number">0</span>] = s[<span class="number">0</span>] + <span class="number">1</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creat_counter</span><span class="params">()</span>:</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line">    <span class="keyword">return</span> counter</span><br></pre></td></tr></table></figure>



<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g8885skue5j30v30u042e.jpg" alt="image-20191023164204053"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g888hveiitj30dd0v4420.jpg" alt="image-20191023165343479"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g888i4jauxj30db0saq6i.jpg" alt="image-20191023165358740"></p>
<p>Ref:</p>
<p><a href="https://www.jianshu.com/p/703ad1289a00" target="_blank" rel="noopener">https://www.jianshu.com/p/703ad1289a00</a></p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/54/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/54/">54</a><span class="page-number current">55</span><a class="page-number" href="/page/56/">56</a><span class="space">&hellip;</span><a class="page-number" href="/page/60/">60</a><a class="extend next" rel="next" href="/page/56/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>